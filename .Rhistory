help(package = 'ggmap')
library(ggmap)
help(package = 'dkahle/ggmap')
devtools::install_github("dkahle/ggmap")
help(package = 'dkahle/ggmap')
help(package = 'ggmap')
hdf <- get_map("houston, texas")
ggmap(hdf, extent = "normal")
library(ggplot2)
library(tidyr)
library(dplyr)
library(GGally)
library(scales)
library(memisc)
library(readr)
library(gridExtra)
library(RColorBrewer)
library(bitops)
library(RCurl)
library(ggmap)
hdf <- get_map("houston, texas")
ggmap(hdf, extent = "normal")
nyc <- get_map('new york city, new york')
ggmap(nyc, extent = 'normal')
setwd('/Users/courtneyfergusonlee/p4')
uber <- read.csv('uber-raw-data-janjune-15.csv')
taxi_lookup <- read.csv('taxi-zone-lookup.csv')
str(taxi_lookup)
str(uber)
table(uber)
# Grab a sample to lighten system load
set.seed(420)
uber_sample <- uber[sample(1:length(uber$locationID), 10000), ]
str(uber_sample)
uber_sample <- inner_join(uber_sample, taxi_lookup, by = c('locationID' = 'LocationID'))
head(uber_sample)
table(uber$locationID)
sapply(uber_samp, table)
dim(uber_sample)
uber_sample$location <-
head(uber, 20)
head(uber, 20)
head(uber_sample)
table(uber_sample$Borough)
table(uber_sample$Zone)
nyc <- get_map('Astoria, new york')
ggmap(nyc, extent = 'normal')
geocode('astoria, new york city new york', output = 'all')
geocode('astoria, new york city new york', output = 'latlon')
geocodeQueryCheck()
lat_lon <- geocode('astoria, new york city new york', output = 'latlon')
lat_lon
class(lat_lon)
lat_lon$lon
print Zone + ', new york city new york'
print 'tazi_Zone' + ', new york city new york'
print('tazi_Zone' + ', new york city new york')
?print
paste('tazi_Zone', 'new york city new york', sep = ', ')
citystate = 'new york city new york'
mutate(taxi_lookup,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat,
lon = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lon)
taxi_lookup <- mutate(taxi_lookup,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat,
lon = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lon)
uber_sample <- inner_join(uber_sample, taxi_lookup, by = c('locationID' = 'LocationID'))
head(uber_sample)
subset(taxi_lookup, lon = NA, lat = NA)
subset(taxi_lookup, lon == NA, lat == NA)
subset(taxi_lookup, taxi_lookup$lon == NA, taxi_lookup$lat == NA)
subset(taxi_lookup, lon == NA or lat == NA)
subset(taxi_lookup, lon == NA | lat == NA)
?subset
names(taxi_lookup)
subset(taxi_lookup, lon == NA)
subset(taxi_lookup, lat == NA)
subset(taxi_lookup, lat == 40.65904)
subset(taxi_lookup, lat > 40.65904)
subset(taxi_lookup, lat > 40.8)
subset(taxi_lookup, lat > 40.9)
subset(taxi_lookup, is.NA(lat))
subset(taxi_lookup, is.na(lat))
subset(taxi_lookup, is.na(lat), is.na(lon))
subset(taxi_lookup, is.na(lat) | is.na(lon))
subset(taxi_lookup, is.na(lat) or is.na(lon))
subset(taxi_lookup, is.na(lat), is.na(lon))
subset(taxi_lookup, is.na(lon))
subset(taxi_lookup, is.na(lat))
taxi_lookup[89, 3]
taxi_lookup[89, 4]
taxi_lookup[89, 4] <- geocode('Flatbush/Ditmas Park, new york city new york',
output = 'latlon')$lat
taxi_lookup[89, 4]
taxi_lookup.na <- subset(taxi_lookup, is.na(lat))
taxi_lookup.na <- mutate(taxi_lookup.na,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
taxi_lookup.na <- mutate(taxi_lookup.na,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
citystate
taxi_lookup
taxi_lookup.na
str(taxi_lookup.na)
taxe_lookup.na$lat <- 40.2
taxi_lookup.na$lat <- 40.2
taxi_lookup.na <- mutate(taxi_lookup.na,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
taxi_lookup.na <- subset(taxi_lookup, is.na(lat))
taxi_lookup.na <- mutate(taxi_lookup,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
taxi_lookup.na <- mutate(taxi_lookup.na,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
zone = 'Flatbush/Ditmas Park'
geocode(paste(zone, citystate, sep = ', '), output = 'latlon')
geocode(paste(zone, citystate, sep = ', '), output = 'latlon')$lat
taxi_lookup.na <- mutate(taxi_lookup.na,
lat = geocode(paste(zone, citystate, sep = ', '), output = 'latlon')$lat)
names(taxi_lookup.na)
names(taxi_lookup.na)[4]
names(taxi_lookup.na)[4] <- 'latitude'
taxi_lookup.na <- mutate(taxi_lookup.na,
lat = geocode(paste(zone, citystate, sep = ', '), output = 'latlon')$lat)
taxi_lookup.na <- mutate(taxi_lookup.na,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
taxi_lookup.na <- mutate(taxi_lookup.na,
latitude = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
names(taxi_lookup.na)
names(taxi_lookup.na)[4] <- 'latitude'
taxi_lookup.na <- mutate(taxi_lookup.na,
latitude = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
taxi_lookup.na
names(taxi_lookup.na)
taxi_lookup.na <- subset(taxi_lookup, is.na(lat))
names(taxi_lookup.na) <- c("LocationID",
"Borough",
"Zone",
"lon",
"latitude")
names(taxi_lookup.na)
taxi_lookup.na <- mutate(taxi_lookup.na,
latitude = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
taxi_lookup.na
taxi_lookup.na <- subset(taxi_lookup, is.na(lat))
names(taxi_lookup.na) <- c("LocationID",
"Borough",
"Zone",
"lon",
"latitude")
taxi_lookup.na
names(taxi_lookup.na) <- c("LocationID",
"Borough",
"Zone",
"latitude",
"lon")
taxi_lookup.na
taxi_lookup.na <- mutate(taxi_lookup.na,
latitude = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat)
taxi_lookup.na
taxi_lookup <- inner_join(taxi_lookup, taxi_lookup.na)
taxi_lookup[94, ]
taxi_lookup
taxi_lookup <- mutate(taxi_lookup,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat,
lon = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lon)
taxi_lookup <- 3
taxi_lookup <- mutate(taxi_lookup,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat,
lon = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lon)
remove(taxi_lookup)
taxi_lookup <- mutate(taxi_lookup,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat,
lon = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lon)
taxi_lookup <- read.csv('taxi-zone-lookup.csv')
taxi_lookup <- mutate(taxi_lookup,
lat = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lat,
lon = geocode(paste(Zone, citystate, sep = ', '), output = 'latlon')$lon)
taxi_lookup.na <- subset(taxi_lookup, is.na(lat))
taxi_lookup.na
taxi_lookup.na <- subset(taxi_lookup, is.na(lon))
taxi_lookup.na
uber_sample <- inner_join(uber_sample, taxi_lookup, by = c('locationID' = 'LocationID'))
head(uber_sample)
taxi_lookup
set.seed(420)
uber_sample <- uber[sample(1:length(uber$locationID), 10000), ]
uber_sample <- inner_join(uber_sample, taxi_lookup, by = c('locationID' = 'LocationID'))
head(uber_sample)
nyc <- get_map('new york city', zoom = 14)
nycMap <- ggmap('houston',
extent = 'device',
legend = 'topleft')
nycMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 4,
data = uber_sample,
geom = 'polygon')
nyc <- get_map('new york city', zoom = 14)
nycMap <- ggmap('new york city',
extent = 'device',
legend = 'topleft')
nycMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 4,
data = uber_sample,
geom = 'polygon')
nyc <- get_map('new york city', zoom = 14)
nycMap <- ggmap('new york city',
extent = 'device',
legend = 'topleft')
ggmap('new york city',
extent = 'device',
legend = 'topleft') +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 4,
data = uber_sample,
geom = 'polygon')
?stat_density2d
houston <- get_map("houston", zoom = 14)
HoustonMap <- ggmap("houston",
extent = "device", legend = "topleft")
HoustonMap +
stat_density2d(
aes(x = lon, y = lat, fill = ..level..,
alpha = ..level..),
size = 2, bins = 4, data = violent_crimes,
geom = "polygon")
houston <- get_map("houston", zoom = 14)
HoustonMap <- get_map("houston",
extent = "device", legend = "topleft")
HoustonMap +
stat_density2d(
aes(x = lon, y = lat, fill = ..level..,
alpha = ..level..),
size = 2, bins = 4, data = violent_crimes,
geom = "polygon")
get_map('houston')
get_map('houston, texas')
?get_map
houston <- get_map("houston", zoom = 14)
HoustonMap <- get_map(houston,
extent = "device", legend = "topleft")
HoustonMap +
stat_density2d(
aes(x = lon, y = lat, fill = ..level..,
alpha = ..level..),
size = 2, bins = 4, data = violent_crimes,
geom = "polygon")
hdf <- get_map("houston, texas")
ggmap(hdf, extent = "normal")
houston <- get_map("houston", zoom = 14)
HoustonMap <- get_map(houston,
extent = "normal", legend = "topleft")
HoustonMap +
stat_density2d(
aes(x = lon, y = lat, fill = ..level..,
alpha = ..level..),
size = 2, bins = 4, data = violent_crimes,
geom = "polygon")
houston <- get_map("houston, texas", zoom = 14)
HoustonMap <- get_map(houston,
extent = "normal", legend = "topleft")
houston <- get_map("houston, texas", zoom = 14)
HoustonMap <- get_map(houston,
extent = "normal")
houston <- get_map("houston, texas", zoom = 14)
HoustonMap <- ggmap(houston,
extent = "normal")
HoustonMap +
stat_density2d(
aes(x = lon, y = lat, fill = ..level..,
alpha = ..level..),
size = 2, bins = 4, data = violent_crimes,
geom = "polygon")
hdf <- get_map("houston, texas")
ggmap(hdf, extent = "normal")
violent_crimes
houston <- get_map("houston, texas", zoom = 14)
HoustonMap <- ggmap(houston,
extent = "normal")
HoustonMap +
stat_density2d(
aes(x = lon, y = lat, fill = ..level..,
alpha = ..level..),
size = 2, bins = 4, data = crime,
geom = "polygon")
houston <- get_map("houston, texas")
ggmap(houston,
extent = "normal")
houston <- get_map("houston, texas")
HoustonMap <- ggmap(houston,
extent = "normal")
HoustonMap +
stat_density2d(
aes(x = lon, y = lat, fill = ..level..,
alpha = ..level..),
size = 2, bins = 4, data = crime,
geom = "polygon")
hdf <- get_map("houston, texas")
ggmap(hdf, extent = "normal")
violent_crimes
houston <- get_map("houston, texas")
HoustonMap <- ggmap(houston,
extent = "device",
legend = "topleft")
HoustonMap +
stat_density2d(
aes(x = lon, y = lat, fill = ..level..,
alpha = ..level..),
size = 2, bins = 4, data = crime,
geom = "polygon")
hdf <- get_map("houston, texas")
ggmap(hdf, extent = "normal")
houston <- get_map("houston, texas", zoom = 14)
HoustonMap <- ggmap(houston,
extent = "device",
legend = "topleft")
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 4,
data = crime,
geom = "polygon")
# only violent crimes
violent_crimes <- subset(crime,
offense != "auto theft"
& offense != "theft"
& offense != "burglary")
# order violent crimes
violent_crimes$offense <- factor(violent_crimes$offense,
levels = c("robbery", "aggravated assault",
"rape", "murder"))
# restrict to downtown
violent_crimes <- subset(violent_crimes,
-95.39681 <= lon & lon <= -95.34188
& 29.73631 <= lat & lat <= 29.78400)
houston <- get_map("houston, texas", zoom = 14)
HoustonMap <- ggmap(houston,
extent = "device",
legend = "topleft")
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 4,
data = crime,
geom = "polygon")
# only violent crimes
violent_crimes <- subset(crime,
offense != "auto theft"
& offense != "theft"
& offense != "burglary")
# order violent crimes
violent_crimes$offense <- factor(violent_crimes$offense,
levels = c("robbery", "aggravated assault",
"rape", "murder"))
# restrict to downtown
violent_crimes <- subset(violent_crimes,
-95.39681 <= lon & lon <= -95.34188
& 29.73631 <= lat & lat <= 29.78400)
houston <- get_map("houston, texas", zoom = 14)
HoustonMap <- ggmap(houston,
extent = "device",
legend = "topleft")
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 4,
data = violent_crimes,
geom = "polygon")
str(violent_crimes)
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 4,
data = violent_crimes,
geom = "polygon") +
facet_wrap(~ day)
?crime
geocodeQueryCheck()
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 5,
data = violent_crimes,
geom = "polygon") +
facet_wrap(~ day)
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 6,
data = violent_crimes,
geom = "polygon") +
facet_wrap(~ day)
head(crime)
str(crime)
table(crime$offense)
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 6,
data = violent_crimes,
geom = "polygon") +
scale_fill_gradient(low = 'black',
high = 'blue') +
facet_wrap(~ day)
?stat_de
?stat_density2d
HoustonMap +
stat_density_2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 6,
data = violent_crimes,
geom = "polygon") +
scale_fill_gradient(low = 'black',
high = 'blue') +
facet_wrap(~ day)
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..),
size = 2,
bins = 6,
data = violent_crimes,
geom = "polygon") +
scale_fill_gradient(low = 'black',
high = 'blue') +
facet_wrap(~ day)
?stat_density2d
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 6,
data = violent_crimes,
geom = "polygon") +
scale_fill_gradient(low = 'black',
high = 'blue') +
facet_wrap(~ day)
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 6,
data = violent_crimes,
geom = "polygon") +
scale_fill_discrete(name = 'Violent Crimes') +
facet_wrap(~ day)
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 6,
data = violent_crimes,
geom = "polygon") +
scale_fill_continuous(name = 'Violent Crimes') +
facet_wrap(~ day)
HoustonMap <- ggmap(houston,
extent = "device",
legend = "bottomright")
HoustonMap +
stat_density2d(aes(x = lon,
y = lat,
fill = ..level..,
alpha = ..level..),
size = 2,
bins = 6,
data = violent_crimes,
geom = "polygon") +
scale_fill_continuous(name = 'Violent Crimes') +
facet_wrap(~ day)
library(maptools)
